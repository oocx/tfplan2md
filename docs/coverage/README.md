# Code Coverage History

This directory contains the historical code coverage data for the tfplan2md project.

## Files

### history.json

A machine-readable JSON file that tracks code coverage metrics over time. This file is automatically updated by the CI pipeline when pull requests are merged.

**Structure:**

```json
{
  "Entries": [
    {
      "Timestamp": "2026-01-19T23:20:39+00:00",
      "CommitSha": "c5b5b6d65c72dbc33f21a10921256567a2ae337c",
      "LineCoverage": 84.48,
      "BranchCoverage": 72.80
    }
  ]
}
```

**Fields:**

- `Timestamp`: UTC timestamp when the coverage was measured
- `CommitSha`: Git commit SHA that the coverage measurement corresponds to
- `LineCoverage`: Percentage of lines covered by tests (0-100)
- `BranchCoverage`: Percentage of branches covered by tests (0-100)

## How Coverage Works

### Automatic Collection

- Code coverage is collected automatically on every pull request
- Coverage metrics are computed from Cobertura XML reports generated by TUnit
- The coverage badge in the README is automatically updated when PRs are merged

### Coverage Enforcement

The PR validation workflow enforces minimum coverage thresholds:

- **Line coverage threshold**: 84.48%
- **Branch coverage threshold**: 72.80%

If a PR reduces coverage below these thresholds, the coverage check will fail and block the merge.

### Maintainer Override

Maintainers can bypass coverage requirements when justified by adding the `coverage-override` label to a pull request. This is useful for:

- Untestable platform-specific code
- Integration code with external dependencies
- Legitimate cases where coverage cannot be improved

When an override is active, the coverage check passes but the coverage metrics are still published for visibility.

## Viewing Coverage Reports

Detailed HTML coverage reports are available as workflow artifacts in the GitHub Actions runs. To view them:

1. Go to the **Actions** tab in the repository
2. Select the **PR Validation** workflow run
3. Download the **coverage-report** artifact
4. Extract and open `index.html` in a browser

## Related Documentation

- [Feature specification](../features/043-code-coverage-ci/specification.md)
- [Architecture documentation](../features/043-code-coverage-ci/architecture.md)
- [Test plan](../features/043-code-coverage-ci/test-plan.md)
