{
  "format_version": "1.2",
  "terraform_version": "1.14.0",
  "resource_changes": [
    {
      "address": "azurerm_network_security_group.app",
      "module_address": null,
      "mode": "managed",
      "type": "azurerm_network_security_group",
      "name": "app",
      "provider_name": "registry.terraform.io/hashicorp/azurerm",
      "change": {
        "actions": ["update"],
        "before": {
          "name": "nsg-app",
          "location": "eastus",
          "resource_group_name": "rg-demo",
          "security_rule": [
            {
              "name": "allow-monitoring",
              "priority": 140,
              "direction": "Inbound",
              "access": "Allow",
              "protocol": "Tcp",
              "source_address_prefixes": ["10.0.3.0/24", "10.0.4.0/24"],
              "source_address_prefix": "*",
              "source_port_range": "*",
              "destination_address_prefix": "10.0.10.0/24",
              "destination_port_range": "443",
              "description": "Monitoring agents"
            },
            {
              "name": "allow-http",
              "priority": 110,
              "direction": "Inbound",
              "access": "Allow",
              "protocol": "Tcp",
              "source_address_prefix": "*",
              "source_port_range": "*",
              "destination_address_prefix": "*",
              "destination_port_range": "80",
              "description": "Allow HTTP"
            },
            {
              "name": "allow-ssh",
              "priority": 120,
              "direction": "Inbound",
              "access": "Allow",
              "protocol": "Tcp",
              "source_address_prefix": "10.0.0.0/8",
              "source_port_range": "*",
              "destination_address_prefix": "*",
              "destination_port_range": "22",
              "description": "Legacy SSH access"
            },
            {
              "name": "allow-dns",
              "priority": 130,
              "direction": "Outbound",
              "access": "Allow",
              "protocol": "Udp",
              "source_address_prefix": "*",
              "source_port_range": "*",
              "destination_address_prefix": "168.63.129.16",
              "destination_port_range": "53",
              "description": "Azure DNS"
            }
          ]
        },
        "after": {
          "name": "nsg-app",
          "location": "eastus",
          "resource_group_name": "rg-demo",
          "security_rule": [
            {
              "name": "allow-https",
              "priority": 100,
              "direction": "Inbound",
              "access": "Allow",
              "protocol": "Tcp",
              "source_address_prefix": "*",
              "source_port_range": "*",
              "destination_address_prefixes": ["*"],
              "destination_port_range": "443",
              "description": "Allow HTTPS traffic"
            },
            {
              "name": "allow-http",
              "priority": 110,
              "direction": "Inbound",
              "access": "Allow",
              "protocol": "Tcp",
              "source_address_prefixes": ["10.0.1.0/24", "10.0.2.0/24"],
              "source_address_prefix": "*",
              "source_port_ranges": ["*"],
              "destination_address_prefix": "*",
              "destination_port_range": "8080",
              "description": "Allow alternate HTTP"
            },
            {
              "name": "allow-dns",
              "priority": 130,
              "direction": "Outbound",
              "access": "Allow",
              "protocol": "Udp",
              "source_address_prefix": "*",
              "source_port_range": "*",
              "destination_address_prefix": "168.63.129.16",
              "destination_port_range": "53",
              "description": "Azure DNS"
            },
            {
              "name": "allow-monitoring",
              "priority": 140,
              "direction": "Inbound",
              "access": "Allow",
              "protocol": "Tcp",
              "source_address_prefixes": ["10.0.3.0/24", "10.0.4.0/24"],
              "source_address_prefix": "*",
              "source_port_range": "*",
              "destination_address_prefix": "10.0.10.0/24",
              "destination_port_range": "443",
              "description": "Monitoring agents"
            }
          ]
        },
        "after_unknown": {},
        "before_sensitive": {},
        "after_sensitive": {}
      }
    },
    {
      "address": "azurerm_network_security_group.new",
      "module_address": null,
      "mode": "managed",
      "type": "azurerm_network_security_group",
      "name": "new",
      "provider_name": "registry.terraform.io/hashicorp/azurerm",
      "change": {
        "actions": ["create"],
        "before": null,
        "after": {
          "name": "nsg-new",
          "location": "eastus",
          "resource_group_name": "rg-demo",
          "security_rule": [
            {
              "name": "allow-web-out",
              "priority": 200,
              "direction": "Outbound",
              "access": "Allow",
              "protocol": "Tcp",
              "source_address_prefix": "*",
              "source_port_range": "*",
              "destination_address_prefix": "*",
              "destination_port_range": "443",
              "description": "Allow outbound HTTPS"
            },
            {
              "name": "allow-health",
              "priority": 210,
              "direction": "Inbound",
              "access": "Allow",
              "protocol": "Tcp",
              "source_address_prefix": "10.0.20.0/24",
              "source_port_range": "*",
              "destination_address_prefix": "*",
              "destination_port_range": "15000",
              "description": "Health probes"
            }
          ]
        },
        "after_unknown": {
          "id": true
        },
        "before_sensitive": {},
        "after_sensitive": {}
      }
    },
    {
      "address": "azurerm_network_security_group.legacy",
      "module_address": null,
      "mode": "managed",
      "type": "azurerm_network_security_group",
      "name": "legacy",
      "provider_name": "registry.terraform.io/hashicorp/azurerm",
      "change": {
        "actions": ["delete"],
        "before": {
          "name": "nsg-legacy",
          "location": "eastus",
          "resource_group_name": "rg-legacy",
          "security_rule": [
            {
              "name": "allow-ftp",
              "priority": 300,
              "direction": "Inbound",
              "access": "Allow",
              "protocol": "Tcp",
              "source_address_prefix": "*",
              "source_port_range": "*",
              "destination_address_prefix": "10.10.5.0/24",
              "destination_port_range": "21",
              "description": "Deprecated FTP"
            }
          ]
        },
        "after": null,
        "after_unknown": {},
        "before_sensitive": {},
        "after_sensitive": {}
      }
    }
  ]
}
