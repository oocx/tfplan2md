# Feature: Report Presentation Enhancements

## Overview

This feature combines multiple visual and tooling improvements to enhance report presentation and usability. It improves the visual appearance of resource blocks, adds metadata display capabilities, enhances the screenshot tool for documentation purposes, and adds semantic icons for common naming attributes.

## User Goals

- **Enhanced Visual Hierarchy**: Users want clearer visual separation between resources in reports through consistent border styling
- **Report Metadata**: Users want to know which version of tfplan2md generated a report and when it was generated
- **Documentation Assets**: Users want to generate screenshots of specific resource types for website and documentation purposes
- **Semantic Clarity**: Users want consistent icon-based visual cues for resource names and resource groups

## Scope

### In Scope

#### 1. Resource Visual Enhancement

All resources in the Markdown output should be wrapped in `<details>` blocks with consistent border styling:

- **Border Style**: 1px solid #f0f0f0, 12px padding (applied as inline styles in markdown)
- **HtmlRendererApp Platform Handling**:
  - Azure DevOps flavor: Preserve border styles from markdown
  - GitHub flavor: Strip styles (GitHub's markdown renderer removes them anyway)
- **Resources Without Details Blocks**: Resources that currently don't use details blocks (e.g., firewall rules, NSGs) must be wrapped in `<details open>` to maintain their expanded visibility by default
- **Resources With Details Blocks**: Existing details blocks should have the border styling applied

#### 2. Screenshot Tool - Partial Page Capture

The screenshot renderer tool must support capturing specific portions of rendered reports:

- **New Argument**: Add option to specify target for partial capture
- **Target Selection Methods**:
  - By Terraform resource id/address: `azurerm_firewall.example` (via `--target-terraform-resource-id`)
  - By selector: a **Playwright selector** string (via `--target-selector`, not limited to pure CSS)
- **Use Case**: Generate screenshots of specific resource types for website feature documentation
- **Behavior**: When partial capture is specified, render only the matched element(s) instead of full page

#### 3. Report Metadata Display

Display tfplan2md version information and generation timestamp in report header:

- **Location**: Header section, below "Terraform Plan Report" title, alongside Terraform version
- **Information Displayed**:
  - tfplan2md version number (e.g., "1.2.3")
  - Git commit hash (short format, 7 characters)
  - Report generation date and time (UTC)
- **Format Example**: `Generated by tfplan2md 1.2.3 (abc1234) on 2026-01-03 14:23:15 UTC | Terraform 1.6.0`
- **CLI Option**: Add `--hide-metadata` flag to suppress the entire version/date line
- **Snapshot Testing**: Snapshot tests must handle variable dates and versions appropriately (mock or filter these values during test comparisons)

#### 4. Name Attribute Icons

Add semantic icons for naming-related attributes:

- **Azure Resource Group Name**: üìÅ (folder icon)
  - Applied to `resource_group_name` attribute in Azure resources
  - Format: `üìÅ my-resource-group`
- **Generic Name Attributes**: üÜî (ID button icon)
  - Applied to `name` attribute across all providers
  - Format: `üÜî my-resource-name`
- **Consistency**: Follow existing semantic formatting patterns (non-breaking space between icon and value, context-aware code wrapping)

### Out of Scope

- Customizable border colors or styling (fixed to #f0f0f0)
- Border styling for non-resource elements (only applies to resource details blocks)
- Full-page layout changes beyond resource borders
- Screenshot capture by coordinate ranges or pixel offsets
- Version information in formats other than the specified format
- Historical version tracking or comparison features
- Name icons for non-standard naming attributes (only `name` and `resource_group_name`)

## User Experience

### Resource Borders

When viewing a report in Azure DevOps:
- Each resource appears in a lightly bordered box (#f0f0f0) with 12px padding
- Visual separation makes it easier to scan multiple resources
- Resources previously without details blocks are now expandable but open by default

When viewing in GitHub:
- Borders are not visible (GitHub strips inline styles)
- HtmlRendererApp GitHub flavor also strips styles for consistency
- Semantic structure (details blocks) remains intact
- Content and functionality unchanged

### Screenshot Tool Usage

```bash
# Capture full report
dotnet run --project src/tools/Oocx.TfPlan2Md.ScreenshotGenerator report.html output.png

# Capture specific resource by address
dotnet run --project src/tools/Oocx.TfPlan2Md.ScreenshotGenerator report.html output.png --target-terraform-resource-id "azurerm_firewall.example"

# Capture by selector (Playwright selector syntax)
dotnet run --project src/tools/Oocx.TfPlan2Md.ScreenshotGenerator report.html output.png --target-selector "details:has(summary:has-text(\"azurerm_firewall\"))"
```

Expected behavior:
- Full capture: Existing behavior (entire page)
- Partial capture: Only the matched element(s) rendered
- Error: When target not found, display clear error message and exit non-zero

### Metadata Display

**Default behavior** (metadata visible):
```markdown
# Terraform Plan Report

Generated by tfplan2md 1.2.3 (abc1234) on 2026-01-03 14:23:15 UTC | Terraform 1.6.0

...
```

**With `--hide-metadata` flag**:
```markdown
# Terraform Plan Report

...
```

### Name Icons

In resource attribute tables:

| Attribute | Value |
|-----------|-------|
| name | `üÜî my-storage-account` |
| resource_group_name | `üìÅ my-resource-group` |
| location | `üåç eastus` |

## Success Criteria

- [ ] All resource types are wrapped in `<details>` blocks with inline border styles in markdown
- [ ] Azure DevOps HTML output shows #f0f0f0 borders on all resources
- [ ] HtmlRendererApp GitHub flavor strips inline styles from details blocks
- [ ] Resources previously without details blocks use `<details open>` and remain expanded
- [ ] Screenshot tool accepts `--target-terraform-resource-id` argument for resource address selection
- [ ] Screenshot tool accepts `--target-selector` argument for CSS selector matching
- [ ] Partial screenshots capture only the specified element(s)
- [ ] Screenshot tool errors gracefully when target not found
- [ ] Report header displays tfplan2md version, commit hash, and generation date
- [ ] Terraform version and metadata appear on same line in header
- [ ] `--hide-metadata` flag suppresses the entire version/date line
- [ ] Snapshot tests pass with stable version/date handling
- [ ] `resource_group_name` attributes display with üìÅ icon
- [ ] Generic `name` attributes (all providers) display with üÜî icon
- [ ] Name icons follow existing semantic formatting patterns (non-breaking space, context-aware wrapping)
- [ ] All existing tests continue to pass
- [ ] Documentation updated with new CLI options and examples

## Open Questions

None - all requirements clarified.
