# Terraform Plan Report

Generated by tfplan2md 1.0.0-alpha.24 (be64fe6) on 2026-01-10 14:15:33 UTC | Terraform 1.14.0

## Summary

| Action | Count | Resource Types |
| -------- | ------- | ---------------- |
| ‚ûï¬†Add | 0 |  |
| üîÑ¬†Change | 1 | 1 azurerm_api_management_policy |
| ‚ôªÔ∏è¬†Replace | 0 |  |
| ‚ùå¬†Destroy | 0 |  |
| **Total** | **1** | |

## Resource Changes

### üì¶¬†Module: root

<details style="margin-bottom:12px; border:1px solid rgb(var(--palette-neutral-10, 153, 153, 153)); padding:12px;">
<summary>üîÑ¬†azurerm_api_management_policy <b><code>global</code></b> ‚Äî | 1üîß¬†xml_content</summary>
<br>

Large values: xml_content (112 lines, 57 changed)

##### **xml_content:**

<pre style="font-family: monospace; line-height: 1.5;"><code>&lt;policies&gt;
  &lt;inbound&gt;
<span style="background-color: #fff5f5; border-left: 3px solid #d73a49; color: #24292e; display: block; padding-left: 8px; margin-left: 0;">-     &lt;!-- Rate limiting policy --&gt;</span>
<span style="background-color: #fff5f5; border-left: 3px solid #d73a49; color: #24292e; display: block; padding-left: 8px; margin-left: 0;">-     &lt;rate-limit calls=&quot;100&quot; renewal-period=&quot;60&quot; /&gt;</span>
<span style="background-color: #fff5f5; border-left: 3px solid #d73a49; color: #24292e; display: block; padding-left: 8px; margin-left: 0;">-     &lt;!-- <span style="background-color: #ffc0c0; color: #24292e;">IP</span> <span style="background-color: #ffc0c0; color: #24292e;">fi</span>lt<span style="background-color: #ffc0c0; color: #24292e;">er</span>ing --&gt;</span>
<span style="background-color: #f0fff4; border-left: 3px solid #28a745; color: #24292e; display: block; padding-left: 8px; margin-left: 0;">+     &lt;!-- <span style="background-color: #acf2bd; color: #24292e;">Rate</span> <span style="background-color: #acf2bd; color: #24292e;">limit</span>i<span style="background-color: #acf2bd; color: #24292e;">ng po</span>l<span style="background-color: #acf2bd; color: #24292e;">icy wi</span>t<span style="background-color: #acf2bd; color: #24292e;">h incr</span>e<span style="background-color: #acf2bd; color: #24292e;">ased lim</span>i<span style="background-color: #acf2bd; color: #24292e;">ts</span> --&gt;</span>
<span style="background-color: #f0fff4; border-left: 3px solid #28a745; color: #24292e; display: block; padding-left: 8px; margin-left: 0;">+     &lt;rate-limit calls=&quot;200&quot; renewal-period=&quot;60&quot; /&gt;</span>
<span style="background-color: #f0fff4; border-left: 3px solid #28a745; color: #24292e; display: block; padding-left: 8px; margin-left: 0;">+     &lt;!-- IP filtering with additional networks --&gt;</span>
    &lt;ip-filter action=&quot;allow&quot;&gt;
      &lt;address&gt;10.0.0.0/24&lt;/address&gt;
      &lt;address&gt;172.16.0.0/16&lt;/address&gt;
<span style="background-color: #f0fff4; border-left: 3px solid #28a745; color: #24292e; display: block; padding-left: 8px; margin-left: 0;">+       &lt;address&gt;192.168.1.0/24&lt;/address&gt;</span>
    &lt;/ip-filter&gt;
<span style="background-color: #fff5f5; border-left: 3px solid #d73a49; color: #24292e; display: block; padding-left: 8px; margin-left: 0;">-     &lt;!-- CORS policy --&gt;</span>
<span style="background-color: #f0fff4; border-left: 3px solid #28a745; color: #24292e; display: block; padding-left: 8px; margin-left: 0;">+     &lt;!-- CORS policy <span style="background-color: #acf2bd; color: #24292e;">with additional origins </span>--&gt;</span>
    &lt;cors allow-credentials=&quot;true&quot;&gt;
      &lt;allowed-origins&gt;
        &lt;origin&gt;https://example.com&lt;/origin&gt;
        &lt;origin&gt;https://app.example.com&lt;/origin&gt;
<span style="background-color: #f0fff4; border-left: 3px solid #28a745; color: #24292e; display: block; padding-left: 8px; margin-left: 0;">+         &lt;origin&gt;https://portal.example.com&lt;/origin&gt;</span>
      &lt;/allowed-origins&gt;
      &lt;allowed-methods&gt;
        &lt;method&gt;GET&lt;/method&gt;
        &lt;method&gt;POST&lt;/method&gt;
        &lt;method&gt;PUT&lt;/method&gt;
        &lt;method&gt;DELETE&lt;/method&gt;
<span style="background-color: #f0fff4; border-left: 3px solid #28a745; color: #24292e; display: block; padding-left: 8px; margin-left: 0;">+         &lt;method&gt;PATCH&lt;/method&gt;</span>
      &lt;/allowed-methods&gt;
      &lt;allowed-headers&gt;
        &lt;header&gt;Content-Type&lt;/header&gt;
        &lt;header&gt;Authorization&lt;/header&gt;
        &lt;header&gt;X-Requested-With&lt;/header&gt;
<span style="background-color: #f0fff4; border-left: 3px solid #28a745; color: #24292e; display: block; padding-left: 8px; margin-left: 0;">+         &lt;header&gt;X-API-Key&lt;/header&gt;</span>
      &lt;/allowed-headers&gt;
    &lt;/cors&gt;
    &lt;!-- Authentication with Azure AD --&gt;
    &lt;validate-jwt header-name=&quot;Authorization&quot; failed-validation-httpcode=&quot;401&quot; failed-validation-error-message=&quot;Unauthorized&quot;&gt;
      &lt;openid-config url=&quot;https://login.microsoftonline.com/common/.well-known/openid-configuration&quot; /&gt;
      &lt;audiences&gt;
        &lt;audience&gt;api://12345678-1234-1234-1234-123456789abc&lt;/audience&gt;
      &lt;/audiences&gt;
      &lt;required-claims&gt;
        &lt;claim name=&quot;roles&quot; match=&quot;any&quot;&gt;
          &lt;value&gt;Reader&lt;/value&gt;
          &lt;value&gt;Writer&lt;/value&gt;
<span style="background-color: #f0fff4; border-left: 3px solid #28a745; color: #24292e; display: block; padding-left: 8px; margin-left: 0;">+           &lt;value&gt;Admin&lt;/value&gt;</span>
        &lt;/claim&gt;
      &lt;/required-claims&gt;
    &lt;/validate-jwt&gt;
<span style="background-color: #fff5f5; border-left: 3px solid #d73a49; color: #24292e; display: block; padding-left: 8px; margin-left: 0;">-     &lt;!-- Set backend service URL --&gt;</span>
<span style="background-color: #fff5f5; border-left: 3px solid #d73a49; color: #24292e; display: block; padding-left: 8px; margin-left: 0;">-     &lt;<span style="background-color: #ffc0c0; color: #24292e;">s</span>et<span style="background-color: #ffc0c0; color: #24292e;">-</span>backend<span style="background-color: #ffc0c0; color: #24292e;">-</span>service <span style="background-color: #ffc0c0; color: #24292e;">base-url=&quot;ht</span>t<span style="background-color: #ffc0c0; color: #24292e;">ps://back</span>end<span style="background-color: #ffc0c0; color: #24292e;">-old.exam</span>p<span style="background-color: #ffc0c0; color: #24292e;">le.c</span>o<span style="background-color: #ffc0c0; color: #24292e;">m&quot;</span> <span style="background-color: #ffc0c0; color: #24292e;">/</span>&gt;</span>
<span style="background-color: #f0fff4; border-left: 3px solid #28a745; color: #24292e; display: block; padding-left: 8px; margin-left: 0;">+     &lt;<span style="background-color: #acf2bd; color: #24292e;">!-- S</span>et<span style="background-color: #acf2bd; color: #24292e;"> </span>backend<span style="background-color: #acf2bd; color: #24292e;"> </span>service <span style="background-color: #acf2bd; color: #24292e;">URL to n</span>e<span style="background-color: #acf2bd; color: #24292e;">w </span>endpo<span style="background-color: #acf2bd; color: #24292e;">int</span> <span style="background-color: #acf2bd; color: #24292e;">--</span>&gt;</span>
<span style="background-color: #f0fff4; border-left: 3px solid #28a745; color: #24292e; display: block; padding-left: 8px; margin-left: 0;">+     &lt;set-backend-service base-url=&quot;https://backend-new.example.com&quot; /&gt;</span>
    &lt;!-- Add custom headers --&gt;
    &lt;set-header name=&quot;X-Environment&quot; exists-action=&quot;override&quot;&gt;
      &lt;value&gt;Production&lt;/value&gt;
    &lt;/set-header&gt;
    &lt;set-header name=&quot;X-Request-Id&quot; exists-action=&quot;override&quot;&gt;
      &lt;value&gt;@(Guid.NewGuid().ToString())&lt;/value&gt;
    &lt;/set-header&gt;
<span style="background-color: #f0fff4; border-left: 3px solid #28a745; color: #24292e; display: block; padding-left: 8px; margin-left: 0;">+     &lt;set-header name=&quot;X-API-Version&quot; exists-action=&quot;override&quot;&gt;</span>
<span style="background-color: #f0fff4; border-left: 3px solid #28a745; color: #24292e; display: block; padding-left: 8px; margin-left: 0;">+       &lt;value&gt;2.0&lt;/value&gt;</span>
<span style="background-color: #f0fff4; border-left: 3px solid #28a745; color: #24292e; display: block; padding-left: 8px; margin-left: 0;">+     &lt;/set-header&gt;</span>
<span style="background-color: #f0fff4; border-left: 3px solid #28a745; color: #24292e; display: block; padding-left: 8px; margin-left: 0;">+     &lt;!-- Request throttling per user --&gt;</span>
<span style="background-color: #f0fff4; border-left: 3px solid #28a745; color: #24292e; display: block; padding-left: 8px; margin-left: 0;">+     &lt;quota-by-key calls=&quot;10000&quot; renewal-period=&quot;3600&quot; counter-key=&quot;@(context.Request.Headers.GetValueOrDefault(&amp;quot;Authorization&amp;quot;,&amp;quot;&amp;quot;))&quot; /&gt;</span>
  &lt;/inbound&gt;
  &lt;backend&gt;
    &lt;base /&gt;
<span style="background-color: #f0fff4; border-left: 3px solid #28a745; color: #24292e; display: block; padding-left: 8px; margin-left: 0;">+     &lt;!-- Retry policy for backend failures --&gt;</span>
<span style="background-color: #f0fff4; border-left: 3px solid #28a745; color: #24292e; display: block; padding-left: 8px; margin-left: 0;">+     &lt;retry condition=&quot;@(context.Response.StatusCode &amp;gt;= 500)&quot; count=&quot;3&quot; interval=&quot;2&quot; first-fast-retry=&quot;true&quot; /&gt;</span>
  &lt;/backend&gt;
  &lt;outbound&gt;
    &lt;base /&gt;
<span style="background-color: #fff5f5; border-left: 3px solid #d73a49; color: #24292e; display: block; padding-left: 8px; margin-left: 0;">-     &lt;!-- Response caching --&gt;</span>
<span style="background-color: #fff5f5; border-left: 3px solid #d73a49; color: #24292e; display: block; padding-left: 8px; margin-left: 0;">-     &lt;cach<span style="background-color: #ffc0c0; color: #24292e;">e-s</span>t<span style="background-color: #ffc0c0; color: #24292e;">o</span>r<span style="background-color: #ffc0c0; color: #24292e;">e</span> d<span style="background-color: #ffc0c0; color: #24292e;">u</span>r<span style="background-color: #ffc0c0; color: #24292e;">ation=&quot;3600&quot;</span> <span style="background-color: #ffc0c0; color: #24292e;">/</span>&gt;</span>
<span style="background-color: #f0fff4; border-left: 3px solid #28a745; color: #24292e; display: block; padding-left: 8px; margin-left: 0;">+     &lt;<span style="background-color: #acf2bd; color: #24292e;">!-- Response </span>cach<span style="background-color: #acf2bd; color: #24292e;">ing wi</span>t<span style="background-color: #acf2bd; color: #24292e;">h va</span>r<span style="background-color: #acf2bd; color: #24292e;">y-by h</span>e<span style="background-color: #acf2bd; color: #24292e;">a</span>d<span style="background-color: #acf2bd; color: #24292e;">e</span>r<span style="background-color: #acf2bd; color: #24292e;">s</span> <span style="background-color: #acf2bd; color: #24292e;">--</span>&gt;</span>
<span style="background-color: #f0fff4; border-left: 3px solid #28a745; color: #24292e; display: block; padding-left: 8px; margin-left: 0;">+     &lt;cache-store duration=&quot;3600&quot; vary-by-developer=&quot;false&quot; vary-by-developer-groups=&quot;false&quot;&gt;</span>
<span style="background-color: #f0fff4; border-left: 3px solid #28a745; color: #24292e; display: block; padding-left: 8px; margin-left: 0;">+       &lt;vary-by-header&gt;Accept&lt;/vary-by-header&gt;</span>
<span style="background-color: #f0fff4; border-left: 3px solid #28a745; color: #24292e; display: block; padding-left: 8px; margin-left: 0;">+       &lt;vary-by-header&gt;Accept-Encoding&lt;/vary-by-header&gt;</span>
<span style="background-color: #f0fff4; border-left: 3px solid #28a745; color: #24292e; display: block; padding-left: 8px; margin-left: 0;">+     &lt;/cache-store&gt;</span>
    &lt;!-- Remove internal headers --&gt;
    &lt;set-header name=&quot;X-AspNet-Version&quot; exists-action=&quot;delete&quot; /&gt;
    &lt;set-header name=&quot;X-Powered-By&quot; exists-action=&quot;delete&quot; /&gt;
<span style="background-color: #f0fff4; border-left: 3px solid #28a745; color: #24292e; display: block; padding-left: 8px; margin-left: 0;">+     &lt;!-- Add security headers --&gt;</span>
<span style="background-color: #f0fff4; border-left: 3px solid #28a745; color: #24292e; display: block; padding-left: 8px; margin-left: 0;">+     &lt;set-header name=&quot;X-Content-Type-Options&quot; exists-action=&quot;override&quot;&gt;</span>
<span style="background-color: #f0fff4; border-left: 3px solid #28a745; color: #24292e; display: block; padding-left: 8px; margin-left: 0;">+       &lt;value&gt;nosniff&lt;/value&gt;</span>
<span style="background-color: #f0fff4; border-left: 3px solid #28a745; color: #24292e; display: block; padding-left: 8px; margin-left: 0;">+     &lt;/set-header&gt;</span>
<span style="background-color: #f0fff4; border-left: 3px solid #28a745; color: #24292e; display: block; padding-left: 8px; margin-left: 0;">+     &lt;set-header name=&quot;X-Frame-Options&quot; exists-action=&quot;override&quot;&gt;</span>
<span style="background-color: #f0fff4; border-left: 3px solid #28a745; color: #24292e; display: block; padding-left: 8px; margin-left: 0;">+       &lt;value&gt;DENY&lt;/value&gt;</span>
<span style="background-color: #f0fff4; border-left: 3px solid #28a745; color: #24292e; display: block; padding-left: 8px; margin-left: 0;">+     &lt;/set-header&gt;</span>
  &lt;/outbound&gt;
  &lt;on-error&gt;
    &lt;base /&gt;
<span style="background-color: #fff5f5; border-left: 3px solid #d73a49; color: #24292e; display: block; padding-left: 8px; margin-left: 0;">-     &lt;!-- Log errors to Application Insights --&gt;</span>
<span style="background-color: #f0fff4; border-left: 3px solid #28a745; color: #24292e; display: block; padding-left: 8px; margin-left: 0;">+     &lt;!-- Log errors to Application Insights <span style="background-color: #acf2bd; color: #24292e;">with additional context </span>--&gt;</span>
    &lt;trace source=&quot;policy-error&quot; severity=&quot;error&quot;&gt;
      &lt;message&gt;@(context.LastError.Message)&lt;/message&gt;
      &lt;metadata name=&quot;request-id&quot; value=&quot;@(context.RequestId)&quot; /&gt;
<span style="background-color: #f0fff4; border-left: 3px solid #28a745; color: #24292e; display: block; padding-left: 8px; margin-left: 0;">+       &lt;metadata name=&quot;operation-name&quot; value=&quot;@(context.Operation.Name)&quot; /&gt;</span>
<span style="background-color: #f0fff4; border-left: 3px solid #28a745; color: #24292e; display: block; padding-left: 8px; margin-left: 0;">+       &lt;metadata name=&quot;status-code&quot; value=&quot;@(context.Response.StatusCode.ToString())&quot; /&gt;</span>
    &lt;/trace&gt;
<span style="background-color: #f0fff4; border-left: 3px solid #28a745; color: #24292e; display: block; padding-left: 8px; margin-left: 0;">+     &lt;!-- Send error notification --&gt;</span>
<span style="background-color: #f0fff4; border-left: 3px solid #28a745; color: #24292e; display: block; padding-left: 8px; margin-left: 0;">+     &lt;send-one-way-request mode=&quot;new&quot;&gt;</span>
<span style="background-color: #f0fff4; border-left: 3px solid #28a745; color: #24292e; display: block; padding-left: 8px; margin-left: 0;">+       &lt;set-url&gt;https://monitoring.example.com/api/alerts&lt;/set-url&gt;</span>
<span style="background-color: #f0fff4; border-left: 3px solid #28a745; color: #24292e; display: block; padding-left: 8px; margin-left: 0;">+       &lt;set-method&gt;POST&lt;/set-method&gt;</span>
<span style="background-color: #f0fff4; border-left: 3px solid #28a745; color: #24292e; display: block; padding-left: 8px; margin-left: 0;">+       &lt;set-header name=&quot;Content-Type&quot; exists-action=&quot;override&quot;&gt;</span>
<span style="background-color: #f0fff4; border-left: 3px solid #28a745; color: #24292e; display: block; padding-left: 8px; margin-left: 0;">+         &lt;value&gt;application/json&lt;/value&gt;</span>
<span style="background-color: #f0fff4; border-left: 3px solid #28a745; color: #24292e; display: block; padding-left: 8px; margin-left: 0;">+       &lt;/set-header&gt;</span>
<span style="background-color: #f0fff4; border-left: 3px solid #28a745; color: #24292e; display: block; padding-left: 8px; margin-left: 0;">+       &lt;set-body&gt;@{</span>
<span style="background-color: #f0fff4; border-left: 3px solid #28a745; color: #24292e; display: block; padding-left: 8px; margin-left: 0;">+         return new JObject(</span>
<span style="background-color: #f0fff4; border-left: 3px solid #28a745; color: #24292e; display: block; padding-left: 8px; margin-left: 0;">+           new JProperty(&amp;quot;error&amp;quot;, context.LastError.Message),</span>
<span style="background-color: #f0fff4; border-left: 3px solid #28a745; color: #24292e; display: block; padding-left: 8px; margin-left: 0;">+           new JProperty(&amp;quot;requestId&amp;quot;, context.RequestId),</span>
<span style="background-color: #f0fff4; border-left: 3px solid #28a745; color: #24292e; display: block; padding-left: 8px; margin-left: 0;">+           new JProperty(&amp;quot;timestamp&amp;quot;, DateTime.UtcNow.ToString())</span>
<span style="background-color: #f0fff4; border-left: 3px solid #28a745; color: #24292e; display: block; padding-left: 8px; margin-left: 0;">+         ).ToString();</span>
<span style="background-color: #f0fff4; border-left: 3px solid #28a745; color: #24292e; display: block; padding-left: 8px; margin-left: 0;">+       }&lt;/set-body&gt;</span>
<span style="background-color: #f0fff4; border-left: 3px solid #28a745; color: #24292e; display: block; padding-left: 8px; margin-left: 0;">+     &lt;/send-one-way-request&gt;</span>
  &lt;/on-error&gt;
&lt;/policies&gt;
</code></pre>

</details>

