{
  "format_version": "1.2",
  "terraform_version": "1.14.0",
  "resource_changes": [
    {
      "address": "azurerm_role_assignment.create_no_description",
      "module_address": "module.security",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "create_no_description",
      "provider_name": "registry.terraform.io/hashicorp/azurerm",
      "change": {
        "actions": ["create"],
        "before": null,
        "after": {
          "scope": "/subscriptions/sub-one/resourceGroups/rg-tfplan2md-demo",
          "role_definition_id": "/subscriptions/sub-one/providers/Microsoft.Authorization/roleDefinitions/acdd72a7-3385-48ef-bd42-f606fba81ae7",
          "role_definition_name": null,
          "principal_id": "11111111-1111-1111-1111-111111111111",
          "principal_type": "User",
          "name": "ra-create"
        },
        "after_unknown": {},
        "before_sensitive": {},
        "after_sensitive": {}
      }
    },
    {
      "address": "azurerm_role_assignment.create_with_description",
      "module_address": "module.security",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "create_with_description",
      "provider_name": "registry.terraform.io/hashicorp/azurerm",
      "change": {
        "actions": ["create"],
        "before": null,
        "after": {
          "scope": "/subscriptions/sub-one/resourceGroups/rg-tfplan2md-demo/providers/Microsoft.Storage/storageAccounts/sttfplan2mdlogs-with-extended-name-1234567890",
          "role_definition_id": "/subscriptions/sub-one/providers/Microsoft.Authorization/roleDefinitions/2a2b9908-6ea1-4ae2-8e65-a410df84e7d1",
          "role_definition_name": null,
          "principal_id": "22222222-2222-2222-2222-222222222222",
          "principal_type": "Group",
          "description": "Allow DevOps team to read logs from the storage account",
          "condition": null,
          "delegated_managed_identity_resource_id": null,
          "name": "ra-storage-reader"
        },
        "after_unknown": {},
        "before_sensitive": {},
        "after_sensitive": {}
      }
    },
    {
      "address": "azurerm_role_assignment.update_assignment",
      "module_address": "module.security",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "update_assignment",
      "provider_name": "registry.terraform.io/hashicorp/azurerm",
      "change": {
        "actions": ["update"],
        "before": {
          "scope": "/subscriptions/sub-one/resourceGroups/rg-tfplan2md-demo/providers/Microsoft.Storage/storageAccounts/sttfplan2mdlogs",
          "role_definition_id": "/subscriptions/sub-one/providers/Microsoft.Authorization/roleDefinitions/2a2b9908-6ea1-4ae2-8e65-a410df84e7d1",
          "role_definition_name": null,
          "principal_id": "22222222-2222-2222-2222-222222222222",
          "principal_type": "Group",
          "description": "Allow team to read storage data",
          "condition": null,
          "delegated_managed_identity_resource_id": null,
          "skip_service_principal_aad_check": false
        },
        "after": {
          "scope": "/subscriptions/sub-one/resourceGroups/rg-tfplan2md-demo/providers/Microsoft.Storage/storageAccounts/sttfplan2mddata",
          "role_definition_id": "/subscriptions/sub-one/providers/Microsoft.Authorization/roleDefinitions/ba92f5b4-2d11-453d-a403-e96b0029c9fe",
          "role_definition_name": null,
          "principal_id": "33333333-3333-3333-3333-333333333333",
          "principal_type": "Group",
          "description": "Upgraded permissions for security auditing",
          "condition": "request.clientip != '10.0.0.0/24'",
          "delegated_managed_identity_resource_id": null,
          "skip_service_principal_aad_check": true
        },
        "after_unknown": {},
        "before_sensitive": {},
        "after_sensitive": {}
      }
    },
    {
      "address": "azurerm_role_assignment.replace_assignment",
      "module_address": "module.security",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "replace_assignment",
      "provider_name": "registry.terraform.io/hashicorp/azurerm",
      "change": {
        "actions": ["create", "delete"],
        "before": {
          "scope": "/subscriptions/sub-two/resourceGroups/rg-production",
          "role_definition_id": "/subscriptions/sub-two/providers/Microsoft.Authorization/roleDefinitions/acdd72a7-3385-48ef-bd42-f606fba81ae7",
          "role_definition_name": null,
          "principal_id": "22222222-2222-2222-2222-222222222222",
          "principal_type": "Group",
          "description": "Read-only access for DevOps"
        },
        "after": {
          "scope": "/subscriptions/sub-two/resourceGroups/rg-production",
          "role_definition_id": null,
          "role_definition_name": "Custom Contributor Long Name 1234567890",
          "principal_id": "33333333-3333-3333-3333-333333333333",
          "principal_type": "Group",
          "description": "Updated role assignment with new permissions"
        },
        "after_unknown": {},
        "before_sensitive": {},
        "after_sensitive": {}
      }
    },
    {
      "address": "azurerm_role_assignment.delete_assignment",
      "module_address": "module.security",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "delete_assignment",
      "provider_name": "registry.terraform.io/hashicorp/azurerm",
      "change": {
        "actions": ["delete"],
        "before": {
          "scope": "/subscriptions/sub-three/resourceGroups/rg-legacy",
          "role_definition_id": "/subscriptions/sub-three/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c",
          "role_definition_name": null,
          "principal_id": "33333333-3333-3333-3333-333333333333",
          "principal_type": "User",
          "description": "Legacy access"
        },
        "after": null,
        "after_unknown": {},
        "before_sensitive": {},
        "after_sensitive": {}
      }
    },
    {
      "address": "azurerm_role_assignment.unmapped_principal",
      "module_address": "module.security",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "unmapped_principal",
      "provider_name": "registry.terraform.io/hashicorp/azurerm",
      "change": {
        "actions": ["create"],
        "before": null,
        "after": {
          "scope": "/subscriptions/sub-four/resourceGroups/rg-long-names-example",
          "role_definition_id": null,
          "role_definition_name": "Extremely Verbose Custom Role Name For Long Output Validation 1234567890",
          "principal_id": "99999999-9999-9999-9999-999999999999",
          "principal_type": "ServicePrincipal",
          "description": null,
          "condition": null,
          "delegated_managed_identity_resource_id": null,
          "name": "unmapped"
        },
        "after_unknown": {},
        "before_sensitive": {},
        "after_sensitive": {}
      }
    }
  ]
}
